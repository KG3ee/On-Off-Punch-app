<mxfile host="app.diagrams.net" modified="2026-02-20" agent="Modern Punch" type="device">
  <diagram id="system-overview" name="System Overview">
    <mxGraphModel dx="1400" dy="900" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Title -->
        <mxCell id="title" value="Modern Punch â€” System Architecture" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=24;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="450" y="20" width="500" height="40" as="geometry"/>
        </mxCell>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FRONTEND LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <mxCell id="fe-group" value="Frontend â€” Next.js (Port 3000)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;verticalAlign=top;fontStyle=1;fontSize=14;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="40" y="80" width="720" height="420" as="geometry"/>
        </mxCell>

        <!-- Public Pages -->
        <mxCell id="pub-group" value="Public" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;verticalAlign=top;fontStyle=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="60" y="110" width="200" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="login" value="/login" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="70" y="140" width="80" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="register" value="/register" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="160" y="140" width="80" height="30" as="geometry"/>
        </mxCell>

        <!-- Admin Pages -->
        <mxCell id="admin-group" value="Admin Pages" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;verticalAlign=top;fontStyle=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="60" y="230" width="330" height="120" as="geometry"/>
        </mxCell>
        <mxCell id="admin-live" value="/admin/live" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="70" y="260" width="90" height="28" as="geometry"/>
        </mxCell>
        <mxCell id="admin-history" value="/admin/history" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="170" y="260" width="90" height="28" as="geometry"/>
        </mxCell>
        <mxCell id="admin-users" value="/admin/users" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="270" y="260" width="90" height="28" as="geometry"/>
        </mxCell>
        <mxCell id="admin-requests" value="/admin/requests" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="70" y="300" width="100" height="28" as="geometry"/>
        </mxCell>
        <mxCell id="admin-password" value="/admin/password" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="180" y="300" width="100" height="28" as="geometry"/>
        </mxCell>

        <!-- Employee Pages -->
        <mxCell id="emp-group" value="Employee Pages" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;verticalAlign=top;fontStyle=1;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="410" y="230" width="330" height="120" as="geometry"/>
        </mxCell>
        <mxCell id="emp-dash" value="/employee/dashboard&#xa;(MEMBER, LEADER,&#xa;MAID, CHEF)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="420" y="258" width="100" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="emp-driver" value="/employee/driver&#xa;(DRIVER only)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="530" y="258" width="90" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="emp-team" value="/employee/team&#xa;(LEADER only)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="630" y="258" width="90" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="emp-requests" value="/employee/requests" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="420" y="308" width="110" height="28" as="geometry"/>
        </mxCell>
        <mxCell id="emp-pw" value="/employee/change-password" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="540" y="308" width="150" height="28" as="geometry"/>
        </mxCell>

        <!-- Role Navigation Summary -->
        <mxCell id="nav-summary" value="Navigation by Role:&#xa;&#xa;ADMIN â†’ Live | History | Users | Requests | Password&#xa;LEADER â†’ Dashboard | Team | Requests | Password&#xa;DRIVER â†’ Dashboard (Driver) | Password&#xa;MEMBER â†’ Dashboard | Requests | Password&#xa;MAID â†’ Dashboard | Requests | Password&#xa;CHEF â†’ Dashboard (+ Meal Ready) | Requests | Password" style="text;html=1;align=left;verticalAlign=top;fillColor=#e1d5e7;strokeColor=#9673a6;rounded=1;fontSize=9;fontFamily=monospace;spacingLeft=8;spacingTop=4;" vertex="1" parent="1">
          <mxGeometry x="60" y="370" width="400" height="120" as="geometry"/>
        </mxCell>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BACKEND LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <mxCell id="be-group" value="Backend â€” NestJS API (Port 4001)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;verticalAlign=top;fontStyle=1;fontSize=14;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="800" y="80" width="760" height="420" as="geometry"/>
        </mxCell>

        <!-- Auth Module -->
        <mxCell id="auth-mod" value="Auth Module&#xa;POST /auth/login&#xa;POST /auth/logout&#xa;POST /auth/change-password&#xa;POST /auth/register-request" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=9;align=left;spacingLeft=6;" vertex="1" parent="1">
          <mxGeometry x="820" y="115" width="165" height="90" as="geometry"/>
        </mxCell>

        <!-- Users Module -->
        <mxCell id="users-mod" value="Users Module&#xa;GET /me&#xa;GET /admin/users&#xa;POST /admin/users&#xa;PATCH /admin/users/:id&#xa;DELETE /admin/users/:id" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=9;align=left;spacingLeft=6;" vertex="1" parent="1">
          <mxGeometry x="1000" y="115" width="160" height="100" as="geometry"/>
        </mxCell>

        <!-- Attendance Module -->
        <mxCell id="att-mod" value="Attendance Module&#xa;POST /attendance/on&#xa;POST /attendance/off&#xa;GET /attendance/me/today&#xa;GET /attendance/me/summary&#xa;GET /attendance/admin/live&#xa;GET /attendance/admin/attendance" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=9;align=left;spacingLeft=6;" vertex="1" parent="1">
          <mxGeometry x="1175" y="115" width="180" height="110" as="geometry"/>
        </mxCell>

        <!-- Breaks Module -->
        <mxCell id="breaks-mod" value="Breaks Module&#xa;POST /breaks/start&#xa;POST /breaks/end&#xa;POST /breaks/cancel&#xa;GET /breaks/policies&#xa;GET /breaks/me/today&#xa;GET /breaks/me/active&#xa;GET /breaks/admin/history" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=9;align=left;spacingLeft=6;" vertex="1" parent="1">
          <mxGeometry x="1370" y="115" width="170" height="120" as="geometry"/>
        </mxCell>

        <!-- Shifts Module -->
        <mxCell id="shifts-mod" value="Shifts Module&#xa;GET/POST /admin/shift-presets&#xa;GET/POST /admin/shift-assignments&#xa;POST /admin/shift-overrides&#xa;GET /shifts/current&#xa;POST /shifts/requests&#xa;GET /shifts/requests/me&#xa;GET /admin/requests&#xa;POST /admin/requests/:id/(approve|reject)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=8;align=left;spacingLeft=6;" vertex="1" parent="1">
          <mxGeometry x="820" y="240" width="215" height="130" as="geometry"/>
        </mxCell>

        <!-- Teams Module -->
        <mxCell id="teams-mod" value="Teams Module&#xa;GET /teams&#xa;POST /teams/admin&#xa;PATCH /teams/admin/:id&#xa;DELETE /teams/admin/:id" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=9;align=left;spacingLeft=6;" vertex="1" parent="1">
          <mxGeometry x="1050" y="240" width="160" height="85" as="geometry"/>
        </mxCell>

        <!-- Driver Requests Module -->
        <mxCell id="driver-mod" value="Driver Requests Module&#xa;POST /driver-requests&#xa;GET /driver-requests/me&#xa;GET /driver-requests/available&#xa;GET /driver-requests/my-assignments&#xa;POST /driver-requests/:id/(accept|complete)&#xa;POST /driver-requests/status&#xa;GET /admin/driver-requests&#xa;POST /admin/driver-requests/:id/(approve|reject)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=8;align=left;spacingLeft=6;" vertex="1" parent="1">
          <mxGeometry x="1225" y="240" width="230" height="130" as="geometry"/>
        </mxCell>

        <!-- Leader Module -->
        <mxCell id="leader-mod" value="Leader Module&#xa;GET /leader/team&#xa;GET /leader/live&#xa;GET /leader/requests&#xa;POST /leader/requests/:id/(approve|reject)&#xa;GET /leader/attendance&#xa;GET /leader/breaks&#xa;GET /leader/drivers" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=8;align=left;spacingLeft=6;" vertex="1" parent="1">
          <mxGeometry x="820" y="385" width="210" height="105" as="geometry"/>
        </mxCell>

        <!-- Registration Module -->
        <mxCell id="reg-mod" value="Registration Module&#xa;GET /admin/registration-requests&#xa;POST /admin/registration-requests/:id/(approve|reject)&#xa;GET /admin/registration-roster&#xa;POST /admin/registration-roster&#xa;DELETE /admin/registration-roster/:id" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=8;align=left;spacingLeft=6;" vertex="1" parent="1">
          <mxGeometry x="1050" y="340" width="250" height="100" as="geometry"/>
        </mxCell>

        <!-- Reports + Jobs -->
        <mxCell id="reports-mod" value="Reports &amp; Jobs&#xa;GET /admin/reports/monthly&#xa;POST /admin/reports/monthly/generate&#xa;POST /internal/jobs/run-daily&#xa;POST /internal/jobs/auto-close-breaks&#xa;POST /internal/jobs/auto-close-stale-duty&#xa;POST /internal/jobs/monthly-snapshot" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=8;align=left;spacingLeft=6;" vertex="1" parent="1">
          <mxGeometry x="1315" y="385" width="225" height="105" as="geometry"/>
        </mxCell>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DATABASE LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <mxCell id="db-group" value="Database â€” PostgreSQL (Neon) + Prisma ORM" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;verticalAlign=top;fontStyle=1;fontSize=14;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="40" y="540" width="1520" height="370" as="geometry"/>
        </mxCell>

        <!-- Core Models -->
        <mxCell id="user-model" value="User&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;id, username&#xa;passwordHash&#xa;firstName, lastName&#xa;displayName&#xa;role (enum)&#xa;teamId â†’ Team&#xa;driverStatus&#xa;isActive" style="shape=table;startSize=20;container=0;collapsible=0;childLayout=tableLayout;fixedRows=0;rowLines=0;fontStyle=1;align=center;resizeLast=0;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=9;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="580" width="150" height="170" as="geometry"/>
        </mxCell>

        <mxCell id="team-model" value="Team&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;id, name&#xa;shiftStartTime&#xa;shiftEndTime&#xa;isActive" style="shape=table;startSize=20;container=0;collapsible=0;childLayout=tableLayout;fixedRows=0;rowLines=0;fontStyle=1;align=center;resizeLast=0;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=9;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="230" y="580" width="130" height="110" as="geometry"/>
        </mxCell>

        <mxCell id="duty-model" value="DutySession&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;id, userId â†’ User&#xa;teamId â†’ Team&#xa;localDate, shiftDate&#xa;punchedOnAt&#xa;punchedOffAt&#xa;status (ACTIVE|CLOSED)&#xa;isLate, lateMinutes&#xa;overtimeMinutes&#xa;shiftPresetId&#xa;shiftPresetSegmentId" style="shape=table;startSize=20;container=0;collapsible=0;childLayout=tableLayout;fixedRows=0;rowLines=0;fontStyle=1;align=center;resizeLast=0;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=9;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="380" y="580" width="175" height="200" as="geometry"/>
        </mxCell>

        <mxCell id="break-model" value="BreakSession&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;id, dutySessionId&#xa;userId â†’ User&#xa;breakPolicyId&#xa;localDate&#xa;startedAt, endedAt&#xa;expectedDurationMinutes&#xa;actualMinutes&#xa;status, isOvertime" style="shape=table;startSize=20;container=0;collapsible=0;childLayout=tableLayout;fixedRows=0;rowLines=0;fontStyle=1;align=center;resizeLast=0;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=9;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="575" y="580" width="170" height="170" as="geometry"/>
        </mxCell>

        <mxCell id="breakpol-model" value="BreakPolicy&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;id, code, name&#xa;expectedDurationMinutes&#xa;dailyLimit, isActive" style="shape=table;startSize=20;container=0;collapsible=0;childLayout=tableLayout;fixedRows=0;rowLines=0;fontStyle=1;align=center;resizeLast=0;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=9;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="575" y="770" width="170" height="100" as="geometry"/>
        </mxCell>

        <mxCell id="shift-model" value="ShiftPreset&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;id, name, timezone&#xa;isActive, isDefault&#xa;teamId â†’ Team&#xa;&#xa;ShiftPresetSegment&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;segmentNo&#xa;startTime, endTime&#xa;crossesMidnight&#xa;lateGraceMinutes" style="shape=table;startSize=20;container=0;collapsible=0;childLayout=tableLayout;fixedRows=0;rowLines=0;fontStyle=1;align=center;resizeLast=0;fillColor=#f5f5f5;strokeColor=#666666;fontSize=9;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="765" y="580" width="165" height="200" as="geometry"/>
        </mxCell>

        <mxCell id="shiftassign-model" value="ShiftAssignment&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;targetType (TEAM|USER)&#xa;targetTeamId / targetUserId&#xa;shiftPresetId&#xa;effectiveFrom&#xa;&#xa;ShiftOverride&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;userId, date&#xa;shiftPresetId" style="shape=table;startSize=20;container=0;collapsible=0;childLayout=tableLayout;fixedRows=0;rowLines=0;fontStyle=1;align=center;resizeLast=0;fillColor=#f5f5f5;strokeColor=#666666;fontSize=9;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="950" y="580" width="170" height="180" as="geometry"/>
        </mxCell>

        <mxCell id="driver-req-model" value="DriverRequest&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;id, userId â†’ User&#xa;requestedDate&#xa;requestedTime&#xa;destination, purpose&#xa;status (PENDING|APPROVED|â€¦)&#xa;driverId â†’ User&#xa;reviewedById â†’ User" style="shape=table;startSize=20;container=0;collapsible=0;childLayout=tableLayout;fixedRows=0;rowLines=0;fontStyle=1;align=center;resizeLast=0;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=9;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1140" y="580" width="175" height="160" as="geometry"/>
        </mxCell>

        <mxCell id="shift-req-model" value="ShiftChangeRequest&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;id, userId â†’ User&#xa;requestType&#xa;shiftPresetId&#xa;requestedDate, reason&#xa;status, adminNote&#xa;reviewedById" style="shape=table;startSize=20;container=0;collapsible=0;childLayout=tableLayout;fixedRows=0;rowLines=0;fontStyle=1;align=center;resizeLast=0;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1140" y="760" width="170" height="140" as="geometry"/>
        </mxCell>

        <mxCell id="roster-model" value="EmployeeRoster&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;id, staffCode&#xa;firstName, lastName&#xa;displayName&#xa;defaultTeamId â†’ Team&#xa;defaultRole&#xa;isActive" style="shape=table;startSize=20;container=0;collapsible=0;childLayout=tableLayout;fixedRows=0;rowLines=0;fontStyle=1;align=center;resizeLast=0;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=9;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="770" width="150" height="130" as="geometry"/>
        </mxCell>

        <mxCell id="regreg-model" value="RegistrationRequest&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;id, staffCode&#xa;firstName, displayName&#xa;desiredUsername&#xa;passwordHash&#xa;status, verificationScore&#xa;rosterEntryId&#xa;requestedTeamId&#xa;reviewedById, approvedUserId" style="shape=table;startSize=20;container=0;collapsible=0;childLayout=tableLayout;fixedRows=0;rowLines=0;fontStyle=1;align=center;resizeLast=0;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=9;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="230" y="710" width="175" height="180" as="geometry"/>
        </mxCell>

        <mxCell id="report-model" value="MonthlyReport&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;teamId, month&#xa;totalSessions, totalWorked&#xa;totalLate, totalOvertime&#xa;generatedById" style="shape=table;startSize=20;container=0;collapsible=0;childLayout=tableLayout;fixedRows=0;rowLines=0;fontStyle=1;align=center;resizeLast=0;fillColor=#f5f5f5;strokeColor=#666666;fontSize=9;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1335" y="580" width="160" height="120" as="geometry"/>
        </mxCell>

        <mxCell id="audit-model" value="AuditEvent&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;userId â†’ User&#xa;action, details&#xa;ipAddress, createdAt" style="shape=table;startSize=20;container=0;collapsible=0;childLayout=tableLayout;fixedRows=0;rowLines=0;fontStyle=1;align=center;resizeLast=0;fillColor=#f5f5f5;strokeColor=#666666;fontSize=9;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1335" y="720" width="160" height="100" as="geometry"/>
        </mxCell>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ROLES LEGEND â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <mxCell id="roles-box" value="Roles (enum)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6e6e6;strokeColor=#999999;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="480" y="370" width="270" height="120" as="geometry"/>
        </mxCell>
        <mxCell id="role-admin" value="ADMIN" style="rounded=1;whiteSpace=wrap;html=1;fillColor=rgba(248,113,113,0.15);strokeColor=#f87171;fontColor=#f87171;fontSize=10;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="495" y="400" width="70" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="role-leader" value="LEADER" style="rounded=1;whiteSpace=wrap;html=1;fillColor=rgba(167,139,250,0.15);strokeColor=#a78bfa;fontColor=#a78bfa;fontSize=10;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="575" y="400" width="70" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="role-driver" value="DRIVER" style="rounded=1;whiteSpace=wrap;html=1;fillColor=rgba(56,189,248,0.15);strokeColor=#38bdf8;fontColor=#38bdf8;fontSize=10;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="655" y="400" width="70" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="role-member" value="MEMBER" style="rounded=1;whiteSpace=wrap;html=1;fillColor=rgba(74,222,128,0.15);strokeColor=#4ade80;fontColor=#4ade80;fontSize=10;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="495" y="435" width="70" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="role-maid" value="MAID" style="rounded=1;whiteSpace=wrap;html=1;fillColor=rgba(244,114,182,0.15);strokeColor=#f472b6;fontColor=#f472b6;fontSize=10;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="575" y="435" width="70" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="role-chef" value="CHEF" style="rounded=1;whiteSpace=wrap;html=1;fillColor=rgba(251,191,36,0.15);strokeColor=#fbbf24;fontColor=#fbbf24;fontSize=10;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="655" y="435" width="70" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="role-note" value="No Breaks: LEADER, DRIVER, MAID, CHEF&#xa;Meal Ready â†’ DriverRequest: CHEF only" style="text;html=1;align=left;verticalAlign=middle;fillColor=none;strokeColor=none;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="495" y="465" width="240" height="25" as="geometry"/>
        </mxCell>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONNECTIONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- Frontend to Backend -->
        <mxCell id="fe-be-arrow" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;exitX=1;exitY=0.5;entryX=0;entryY=0.5;strokeColor=#333333;strokeWidth=2;fontSize=10;" edge="1" source="fe-group" target="be-group" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="fe-be-label" value="REST API&#xa;(JWT Auth)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontStyle=1;" vertex="1" connectable="0" parent="fe-be-arrow">
          <mxGeometry x="-0.1" relative="1" as="geometry">
            <mxPoint as="offset"/>
          </mxGeometry>
        </mxCell>

        <!-- Backend to Database -->
        <mxCell id="be-db-arrow" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;exitX=0.5;exitY=1;entryX=0.7;entryY=0;strokeColor=#333333;strokeWidth=2;fontSize=10;" edge="1" source="be-group" target="db-group" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="be-db-label" value="Prisma ORM" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontStyle=1;" vertex="1" connectable="0" parent="be-db-arrow">
          <mxGeometry x="-0.1" relative="1" as="geometry">
            <mxPoint as="offset"/>
          </mxGeometry>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>

  <diagram id="workflows" name="Key Workflows">
    <mxGraphModel dx="1400" dy="900" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <mxCell id="wf-title" value="Key Workflows" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=22;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="550" y="10" width="200" height="40" as="geometry"/>
        </mxCell>

        <!-- â”€â”€ Workflow 1: Punch On/Off â”€â”€ -->
        <mxCell id="wf1-box" value="1. Punch On / Off (All Roles)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="40" y="60" width="620" height="110" as="geometry"/>
        </mxCell>
        <mxCell id="wf1-1" value="User taps&#xa;Punch ON" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="60" y="95" width="80" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="wf1-2" value="POST&#xa;/attendance/on" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="170" y="95" width="90" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="wf1-3" value="Resolve shift,&#xa;calc late mins,&#xa;create DutySession" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="290" y="90" width="120" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="wf1-4" value="User taps&#xa;Punch OFF" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="440" y="95" width="80" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="wf1-5" value="Close session,&#xa;calc overtime" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="550" y="95" width="90" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="wf1-a1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#82b366;" edge="1" source="wf1-1" target="wf1-2" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>
        <mxCell id="wf1-a2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#82b366;" edge="1" source="wf1-2" target="wf1-3" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>
        <mxCell id="wf1-a3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#82b366;" edge="1" source="wf1-3" target="wf1-4" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>
        <mxCell id="wf1-a4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#82b366;" edge="1" source="wf1-4" target="wf1-5" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>

        <!-- â”€â”€ Workflow 2: Chef Meal Ready â”€â”€ -->
        <mxCell id="wf2-box" value="2. Chef Meal Ready â†’ Driver Pickup" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="40" y="190" width="760" height="110" as="geometry"/>
        </mxCell>
        <mxCell id="wf2-1" value="Chef taps&#xa;ðŸ³ Breakfast Ready" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#fbbf24;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="60" y="225" width="110" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="wf2-2" value="POST&#xa;/driver-requests&#xa;(dest: Kitchen)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="200" y="225" width="105" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="wf2-3" value="Admin sees&#xa;new request in&#xa;Driver Requests" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="335" y="220" width="110" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="wf2-4" value="Admin approves&#xa;&amp; assigns Driver" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="475" y="225" width="110" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="wf2-5" value="Driver accepts,&#xa;picks up meal,&#xa;marks Complete" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#38bdf8;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="615" y="220" width="110" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="wf2-a1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#d6b656;" edge="1" source="wf2-1" target="wf2-2" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>
        <mxCell id="wf2-a2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#d6b656;" edge="1" source="wf2-2" target="wf2-3" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>
        <mxCell id="wf2-a3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#d6b656;" edge="1" source="wf2-3" target="wf2-4" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>
        <mxCell id="wf2-a4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#d6b656;" edge="1" source="wf2-4" target="wf2-5" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>

        <!-- â”€â”€ Workflow 3: Registration â”€â”€ -->
        <mxCell id="wf3-box" value="3. Employee Self-Registration" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="40" y="320" width="760" height="110" as="geometry"/>
        </mxCell>
        <mxCell id="wf3-1" value="New employee&#xa;fills /register form&#xa;(staffCode, name, pw)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#b85450;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="60" y="355" width="130" height="55" as="geometry"/>
        </mxCell>
        <mxCell id="wf3-2" value="POST /auth/&#xa;register-request&#xa;(auto-verify vs roster)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="220" y="355" width="120" height="55" as="geometry"/>
        </mxCell>
        <mxCell id="wf3-3" value="Admin sees in&#xa;Approval Queue&#xa;with score" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="370" y="355" width="110" height="55" as="geometry"/>
        </mxCell>
        <mxCell id="wf3-4" value="Admin approves&#xa;â†’ User created&#xa;with roster's&#xa;defaultTeam + defaultRole" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="510" y="348" width="130" height="65" as="geometry"/>
        </mxCell>
        <mxCell id="wf3-5" value="Employee can&#xa;now login" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="670" y="355" width="100" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="wf3-a1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#b85450;" edge="1" source="wf3-1" target="wf3-2" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>
        <mxCell id="wf3-a2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#b85450;" edge="1" source="wf3-2" target="wf3-3" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>
        <mxCell id="wf3-a3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#b85450;" edge="1" source="wf3-3" target="wf3-4" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>
        <mxCell id="wf3-a4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#b85450;" edge="1" source="wf3-4" target="wf3-5" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>

        <!-- â”€â”€ Workflow 4: Breaks â”€â”€ -->
        <mxCell id="wf4-box" value="4. Break Session (MEMBER only)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="40" y="450" width="620" height="110" as="geometry"/>
        </mxCell>
        <mxCell id="wf4-1" value="Member selects&#xa;break policy&#xa;(BWC, WC, CY...)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="60" y="485" width="110" height="55" as="geometry"/>
        </mxCell>
        <mxCell id="wf4-2" value="POST&#xa;/breaks/start" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="200" y="490" width="90" height="45" as="geometry"/>
        </mxCell>
        <mxCell id="wf4-3" value="Timer runs,&#xa;banner shows&#xa;elapsed/expected" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="320" y="485" width="110" height="55" as="geometry"/>
        </mxCell>
        <mxCell id="wf4-4" value="POST /breaks/end&#xa;or /breaks/cancel&#xa;(or auto-close job)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="460" y="485" width="120" height="55" as="geometry"/>
        </mxCell>
        <mxCell id="wf4-a1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#6c8ebf;" edge="1" source="wf4-1" target="wf4-2" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>
        <mxCell id="wf4-a2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#6c8ebf;" edge="1" source="wf4-2" target="wf4-3" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>
        <mxCell id="wf4-a3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#6c8ebf;" edge="1" source="wf4-3" target="wf4-4" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell>

        <!-- â”€â”€ Workflow 5: Leader Team Management â”€â”€ -->
        <mxCell id="wf5-box" value="5. Leader Team Management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="40" y="580" width="500" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="wf5-tabs" value="Tabs: ðŸ“¡ Live | ðŸ“‹ Requests | ðŸ“Š History | ðŸš— Drivers&#xa;&#xa;â€¢ Live â€” see team active sessions in real-time&#xa;â€¢ Requests â€” approve/reject shift change requests&#xa;â€¢ History â€” view team attendance + break history&#xa;â€¢ Drivers â€” see driver availability status" style="text;html=1;align=left;verticalAlign=top;fillColor=#ffffff;strokeColor=#9673a6;rounded=1;fontSize=9;spacingLeft=8;spacingTop=4;" vertex="1" parent="1">
          <mxGeometry x="55" y="605" width="470" height="65" as="geometry"/>
        </mxCell>

        <!-- â”€â”€ Tech Stack Note â”€â”€ -->
        <mxCell id="techstack" value="Tech Stack&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;Frontend: Next.js 15 (App Router) + React&#xa;Backend: NestJS + Prisma ORM&#xa;Database: PostgreSQL (Neon)&#xa;Auth: JWT (httpOnly cookie)&#xa;Styling: Custom CSS (globals.css)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#999999;fontSize=10;align=left;spacingLeft=10;fontFamily=monospace;" vertex="1" parent="1">
          <mxGeometry x="580" y="460" width="260" height="120" as="geometry"/>
        </mxCell>

        <!-- Groups -->
        <mxCell id="groups-note" value="Groups&#xa;â”€â”€â”€â”€â”€â”€â”€â”€â”€&#xa;Real teams: CS, HM-2, HM-3, HM-4, HM-5&#xa;Service: fallback for users with no team&#xa;(Driver, Maid, Chef typically use Service)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#999999;fontSize=10;align=left;spacingLeft=10;fontFamily=monospace;" vertex="1" parent="1">
          <mxGeometry x="580" y="600" width="280" height="90" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
